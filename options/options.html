<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AnkiTrans 设置指南</title>
  <link rel="stylesheet" href="../popup/popup.css"> <!-- 复用基础样式 -->
  <link rel="stylesheet" href="options.css">
</head>
<body>
  <div class="app-layout">
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="logo">
          <img src="../icons/icon48.png" alt="AnkiTrans Logo" class="logo-icon-img" style="width: 28px; height: 28px;">
          <h1>AnkiTrans</h1>
        </div>
      </div>
      <nav class="sidebar-nav">
        <ul>
          <li><a href="#intro" class="nav-link active">👋 欢迎使用 AnkiTrans</a></li>
          <li><a href="#quick-start" class="nav-link">🚀 快速开始</a></li>
          <li><a href="#settings" class="nav-link">⚙️ 功能设置</a></li>
          <li><a href="#features" class="nav-link">✨ 核心功能</a></li>
          <li><a href="#templates" class="nav-link">🎨 卡片模板说明</a></li>
          <li><a href="#faq" class="nav-link">❓ 常见问题</a></li>
        </ul>
      </nav>
      <div class="sidebar-footer-info">
        <small>AnkiTrans v1.1.1</small>
      </div>
    </aside>
    <main class="main-content">
      <div class="content-container">


    <div class="options-main">
      <div class="intro-card" id="intro">
        <h2>👋 欢迎使用 AnkiTrans</h2>
        <p>AnkiTrans 是一款极简的划词制卡工具，致力于帮助您在浏览网页时，以最快速度将生词捕捉并同步到 Anki 中。</p>
      </div>

      <section class="section" id="quick-start">
        <h3>🚀 快速开始</h3>
        <ul class="steps-list">
          <li>
            <div class="step-num">1</div>
            <div class="step-content">
              <h4>启动 Anki</h4>
              <p>确保 Anki 桌面版已打开，并且安装了 <a href="https://ankiweb.net/shared/info/2055492159" target="_blank">AnkiConnect</a> 插件。</p>
            </div>
          </li>
          <li>
            <div class="step-num">2</div>
            <div class="step-content">
              <h4>选择目标牌组</h4>
              <p>点击浏览器右上角的扩展图标，在弹窗中选择您的目标牌组（Deck）。<strong>这是必须的步骤</strong>。</p>
            </div>
          </li>
          <li>
            <div class="step-num">3</div>
            <div class="step-content">
              <h4>开始制卡</h4>
              <p>在任意网页选中单词，根据习惯选择以下任一方式：</p>
              
              <div class="method-group">
                  <div class="method-row">
                      <span class="method-tag recom">推荐</span>
                      <strong>先查后存：</strong> 点击悬浮图标查看释义 -> 点击「添加到 Anki」。
                  </div>
                  <div class="method-row">
                      <span class="method-tag speed">极速</span>
                      <strong>快捷键：</strong> 直接按下 <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>A</kbd>。
                  </div>
                  <div class="method-row">
                      <span class="method-tag classic">传统</span>
                      <strong>右键菜单：</strong> 右键选择「AnkiTrans: 添加到 Anki」。
                  </div>
              </div>
            </div>
          </li>
        </ul>
      </section>

      <section class="section" id="settings">
        <h3>⚙️ 功能设置</h3>
        <div class="settings-card" style="background: var(--input-bg); padding: 20px; border-radius: 12px; border: 1px solid var(--border-color); margin-bottom: 20px;">
            <div class="setting-item" style="display: flex; justify-content: space-between; align-items: center;">
                <div class="setting-info">
                    <h4 style="margin: 0 0 4px 0; color: var(--text-color);">启用卡片预览</h4>
                    <p style="margin: 0; font-size: 13px; color: var(--text-secondary);">制卡前显示预览弹窗，允许确认或取消。关闭后将直接静默添加。</p>
                </div>
                <label class="switch">
                    <input type="checkbox" id="enable-preview">
                    <span class="slider round"></span>
                </label>
            </div>
        </div>

        <div class="settings-card" style="background: var(--input-bg); padding: 20px; border-radius: 12px; border: 1px solid var(--border-color);">
            <div class="setting-item" style="margin-bottom: 24px;">
                <div class="setting-info" style="margin-bottom: 12px; position: relative; padding-right: 30px;">
                    <h4 style="margin: 0 0 4px 0; color: var(--text-color);">快捷键 1：直接添加到 Anki</h4>
                    <div class="info-tooltip-container" data-tooltip="系统保留快捷键不可用：&#10;Ctrl + C/V/X/A/Z (剪贴板/撤销)&#10;Ctrl + T/W/N (标签页控制)&#10;Ctrl + R/F/P/S/O/D (页面操作)">
                        <span class="info-icon">i</span>
                    </div>
                    <p style="margin: 0; font-size: 13px; color: var(--text-secondary);">选中文字后，直接添加卡片（默认：Ctrl+Shift+A）。</p>
                </div>
                <div class="shortcut-input-container">
                    <input type="text" id="shortcut-input" class="shortcut-record-input" placeholder="点击录制快捷键..." readonly>
                    <button id="reset-shortcut" class="btn-reset" title="恢复默认">↺</button>
                </div>
                <p id="shortcut-status" class="shortcut-msg"></p>
            </div>

            <div class="setting-item" style="border-top: 1px solid var(--border-color); padding-top: 24px;">
                <div class="setting-info" style="margin-bottom: 12px;">
                    <h4 style="margin: 0 0 4px 0; color: var(--text-color);">快捷键 2：显示翻译卡片</h4>
                    <p style="margin: 0; font-size: 13px; color: var(--text-secondary);">选中文字后，显示翻译卡片（默认：Alt+Q）。</p>
                </div>
                <div class="shortcut-input-container">
                    <input type="text" id="shortcut-lookup-input" class="shortcut-record-input" placeholder="点击录制快捷键..." readonly>
                    <button id="reset-shortcut-lookup" class="btn-reset" title="恢复默认">↺</button>
                </div>
                <p id="shortcut-lookup-status" class="shortcut-msg"></p>
            </div>
        </div>
      </section>

      <section class="section" id="features">
        <h3>✨ 核心功能</h3>
        <div class="features-grid">
          <div class="feature-card">
            <span class="feature-icon">🔍</span>
            <h4>划词即译</h4>
            <p>选中单词即刻弹出释义小卡片，所见即所得，保持阅读心流。</p>
          </div>
          <div class="feature-card">
            <span class="feature-icon">🔊</span>
            <h4>双语发音</h4>
            <p>自动提取并保存美式与英式发音，卡片预览支持即时试听。</p>
          </div>
          <div class="feature-card">
            <span class="feature-icon">📖</span>
            <h4>必应词典</h4>
            <p>集成必应词典权威释义，包含音标、例句、搭配等丰富信息。</p>
          </div>
          <div class="feature-card">
            <span class="feature-icon">⚡</span>
            <h4>极速添加</h4>
            <p>无缝后台处理，不打断阅读心流，支持批量操作。</p>
          </div>
          <div class="feature-card">
            <span class="feature-icon">👁️</span>
            <h4>可视预览</h4>
            <p>制卡前提供完整卡片预览，支持发音试听，拒绝“盲盒”式制卡。</p>
          </div>
          <div class="feature-card">
            <span class="feature-icon">🎨</span>
            <h4>精美模板</h4>
            <p>内置专业设计的 Anki 卡片模板，完美适配桌面端与移动端。</p>
          </div>
        </div>
      </section>

      <section class="section" id="templates">
        <h3>🎨 卡片模板说明</h3>
        <div class="template-card" style="background: var(--input-bg); padding: 25px; border-radius: 12px; border: 1px solid var(--border-color);">
            <p style="margin-bottom: 20px; color: var(--text-secondary); line-height: 1.6;">
                本扩展程序会自动在您的 Anki 中创建一个名为 <strong>AnkiTrans</strong> 的专属卡片模板（Note Type）。<br>
                该模板经过精心设计，包含以下字段以呈现来自 <strong>必应词典 (© Microsoft)</strong> 的丰富数据：
            </p>
            
            <!-- Field Explanations -->
            <div class="field-table-container">
                <table class="field-table">
                    <thead>
                        <tr>
                            <th>字段名 (Field)</th>
                            <th>说明 (Description)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>Word</code></td>
                            <td>单词原文，卡片正面核心内容。</td>
                        </tr>
                        <tr>
                            <td><code>Phonetic</code></td>
                            <td>双语音标（美式/英式），包含发音按钮 HTML 代码。</td>
                        </tr>
                        <tr>
                            <td><code>Translation</code></td>
                            <td>主要中文释义，包含词性标注。</td>
                        </tr>
                        <tr>
                            <td><code>Inflections</code></td>
                            <td>单词变形信息（如：复数、过去式、进行时等）。</td>
                        </tr>
                        <tr>
                            <td><code>Example</code></td>
                            <td>精选双语例句（通常包含 1-3 个例句）。</td>
                        </tr>
                        <tr>
                            <td><code>Collocations</code></td>
                            <td>常见词组搭配。</td>
                        </tr>
                        <tr>
                            <td><code>Synonyms</code></td>
                            <td>同义词或近义词。</td>
                        </tr>
                        <tr>
                            <td><code>DomainDefs</code></td>
                            <td>详细释义（包含<strong>英汉/英英分类</strong>）及网络释义。</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="preview-container" id="preview-container-host" style="border: none; padding: 20px; background: transparent; display: flex; justify-content: center;">
                <!-- Content will be injected by options.js -->
                <div id="mock-loading" style="color: var(--text-secondary);">⏳ Loading preview...</div>
            </div>
            
            <p style="margin-top: 15px; font-size: 12px; color: var(--text-secondary); text-align: center;">
                * 您可以随时在 Anki 的 "管理笔记类型" 中自定义此模板的样式。
            </p>
        </div>
      </section>

      <section class="section" id="faq">
        <h3>❓ 常见问题</h3>
        <div class="faq-item">
          <h4>Q: 为什么提示 "Extension context invalidated"?</h4>
          <p>A: 这通常发生在插件更新后。请尝试<strong>手动重新加载页面</strong>，或者在扩展管理页点击刷新按钮。</p>
        </div>
        <div class="faq-item">
          <h4>Q: 图片或音频无法下载？</h4>
          <p>A: 请检查网络连接，确保能够访问 cn.bing.com。</p>
        </div>
      </section>
    </div>

    <footer class="footer options-footer">
      <div class="disclaimer" style="margin-bottom: 20px; font-size: 12px; opacity: 0.8; max-width: 700px; margin-left: auto; margin-right: auto; text-align: left; line-height: 1.5; background: rgba(0,0,0,0.03); padding: 15px; border-radius: 8px;">
        <p style="margin-bottom: 8px; text-align: center;"><strong>⚠️ 免责声明 (Disclaimer)</strong></p>
        <ul style="padding-left: 15px; margin: 0;">
            <li style="margin-bottom: 6px;"><strong>学术用途：</strong> 本扩展程序仅供个人学习、研究及学术交流使用，严禁用于任何商业用途。</li>
            <li style="margin-bottom: 6px;"><strong>数据来源：</strong> 所有词典数据均实时检索自 <a href="https://cn.bing.com/dict" target="_blank" style="color: inherit;">Bing Dictionary（必应词典）</a>，其版权及相关知识产权归 Microsoft 及其内容提供商所有。本工具仅作为浏览器辅助工具，不存储、不修改、不分发原始词典数据库。</li>
            <li style="margin-bottom: 6px;"><strong>第三方关联：</strong> 本工具与 Microsoft、Bing 或 Anki 无任何官方关联。</li>
            <li style="margin-bottom: 6px;"><strong>风险承担：</strong> 用户在使用本工具时，应遵守 Microsoft 的服务条款。因用户滥用（如高频爬取导致封禁 IP）或违反相关法律法规所产生的一切后果，由用户本人承担，开发者不承担任何法律责任。</li>
            <li><strong>动态调整：</strong> 若原权利方提出要求，开发者有权在不事先通知的情况下停止相关功能或下架本程序。</li>
        </ul>
      </div>
      <p>Made with ❤️ by AnkiTrans Team</p>
    </footer>
      </div>
    </main>
  </div>
  <script type="module" src="options.js"></script>
</body>
</html>
